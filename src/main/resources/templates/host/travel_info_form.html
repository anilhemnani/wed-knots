<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{_bootstrap_head :: head}"></th:block>
<body class="bg-light">
<nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
    <div class="container-fluid">
        <a class="navbar-brand" href="/">
          <img src="/icon" height="30" class="me-2" alt="WedKnots">
          WedKnots â€“ The Smart Wedding Concierge
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="/host/dashboard">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="/logout">Logout</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Edit Travel Information</h2>
        <a th:href="@{/host/travel-info(eventId=${eventId})}" class="btn btn-secondary">Back to List</a>
    </div>

    <div class="card">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Guest: <span th:text="${guest.contactName}">Guest Name</span></h5>
            <small th:text="${guest.familyName}">Family Name</small>
        </div>
        <div class="card-body">
            <form method="post" th:action="@{/host/travel-info/save}" th:object="${travelInfo}">
                <input type="hidden" name="guestId" th:value="${guest.id}" />
                <input type="hidden" name="eventId" th:value="${eventId}" />
                <input type="hidden" th:field="*{id}" />

                <!-- Arrival Information -->
                <h4 class="mt-3 mb-3">Arrival Information</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="arrivalMode" class="form-label">Arrival Mode</label>
                        <select class="form-select" id="arrivalMode" th:field="*{arrivalMode}">
                            <option value="">Select Mode</option>
                            <option value="FLIGHT">Flight</option>
                            <option value="TRAIN">Train</option>
                            <option value="CAR">Car</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="arrivalDateTime" class="form-label">Arrival Date & Time</label>
                        <input type="datetime-local" class="form-control" id="arrivalDateTime" th:field="*{arrivalDateTime}"
                               placeholder="e.g., Jan 15, 2025 10:30 AM" />
                    </div>
                </div>

                <div class="row" id="arrivalFlightFields" style="display:none;">
                    <div class="col-md-6 mb-3">
                        <label for="arrivalFlightNumber" class="form-label">Flight Number (if applicable)</label>
                        <input type="text" class="form-control" id="arrivalFlightNumber" th:field="*{arrivalFlightNumber}"
                               placeholder="e.g., AI 123" />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="arrivalAirport" class="form-label">Airport (if applicable)</label>
                        <input type="text" class="form-control" id="arrivalAirport" th:field="*{arrivalAirport}"
                               th:value="${travelInfo.arrivalAirport ?: event.preferredTravelAirport}" placeholder="e.g., Delhi International" />
                    </div>
                </div>

                <div class="row" id="arrivalTrainFields" style="display:none;">
                    <div class="col-md-6 mb-3">
                        <label for="arrivalTrainNumber" class="form-label">Train Number (if applicable)</label>
                        <input type="text" class="form-control" id="arrivalTrainNumber" th:field="*{arrivalTrainNumber}"
                               placeholder="e.g., 12345" />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="arrivalStation" class="form-label">Station (if applicable)</label>
                        <input type="text" class="form-control" id="arrivalStation" th:field="*{arrivalStation}"
                               th:value="${travelInfo.arrivalStation ?: event.preferredTravelStation}" placeholder="e.g., New Delhi Railway Station" />
                    </div>
                </div>

                <!-- Departure Information -->
                <h4 class="mt-4 mb-3">Departure Information</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="departureMode" class="form-label">Departure Mode</label>
                        <select class="form-select" id="departureMode" th:field="*{departureMode}">
                            <option value="">Select Mode</option>
                            <option value="FLIGHT">Flight</option>
                            <option value="TRAIN">Train</option>
                            <option value="CAR">Car</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="departureDateTime" class="form-label">Departure Date & Time</label>
                        <input type="datetime-local" class="form-control" id="departureDateTime" th:field="*{departureDateTime}"
                               placeholder="e.g., Jan 17, 2025 3:00 PM" />
                    </div>
                </div>

                <div class="row" id="departureFlightFields" style="display:none;">
                    <div class="col-md-6 mb-3">
                        <label for="departureFlightNumber" class="form-label">Flight Number (if applicable)</label>
                        <input type="text" class="form-control" id="departureFlightNumber" th:field="*{departureFlightNumber}"
                               placeholder="e.g., AI 456" />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="departureAirport" class="form-label">Airport (if applicable)</label>
                        <input type="text" class="form-control" id="departureAirport" th:field="*{departureAirport}"
                               th:value="${travelInfo.departureAirport ?: event.preferredTravelAirport}" placeholder="e.g., Mumbai International" />
                    </div>
                </div>

                <div class="row" id="departureTrainFields" style="display:none;">
                    <div class="col-md-6 mb-3">
                        <label for="departureTrainNumber" class="form-label">Train Number (if applicable)</label>
                        <input type="text" class="form-control" id="departureTrainNumber" th:field="*{departureTrainNumber}"
                               placeholder="e.g., 54321" />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="departureStation" class="form-label">Station (if applicable)</label>
                        <input type="text" class="form-control" id="departureStation" th:field="*{departureStation}"
                               th:value="${travelInfo.departureStation ?: event.preferredTravelStation}" placeholder="e.g., Mumbai Central" />
                    </div>
                </div>

                <!-- Additional Requirements -->
                <h4 class="mt-4 mb-3">Additional Requirements</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="needsPickup" th:field="*{needsPickup}" />
                            <label class="form-check-label" for="needsPickup">
                                Needs Pickup Service
                            </label>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="needsDrop" th:field="*{needsDrop}" />
                            <label class="form-check-label" for="needsDrop">
                                Needs Drop Service
                            </label>
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="specialRequirements" class="form-label">Special Requirements</label>
                    <textarea class="form-control" id="specialRequirements" th:field="*{specialRequirements}"
                              rows="3" placeholder="Any special requirements or preferences"></textarea>
                </div>

                <div class="mb-3">
                    <label for="notes" class="form-label">Notes</label>
                    <textarea class="form-control" id="notes" th:field="*{notes}"
                              rows="3" placeholder="Additional notes"></textarea>
                </div>

                <div class="d-flex justify-content-between">
                    <a th:href="@{/host/travel-info(eventId=${eventId})}" class="btn btn-secondary">Cancel</a>
                    <button type="submit" class="btn btn-primary">Save Travel Information</button>
                </div>
            </form>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
function toggleArrivalFields() {
    const mode = document.getElementById('arrivalMode').value;
    const flight = document.getElementById('arrivalFlightFields');
    const train = document.getElementById('arrivalTrainFields');
    flight.style.display = 'none';
    train.style.display = 'none';
    if (mode === 'FLIGHT') {
        flight.style.display = 'flex';
        document.getElementById('arrivalTrainNumber').value = '';
        document.getElementById('arrivalStation').value = '';
    } else if (mode === 'TRAIN') {
        train.style.display = 'flex';
        document.getElementById('arrivalFlightNumber').value = '';
        document.getElementById('arrivalAirport').value = '';
    } else {
        document.getElementById('arrivalFlightNumber').value = '';
        document.getElementById('arrivalAirport').value = '';
        document.getElementById('arrivalTrainNumber').value = '';
        document.getElementById('arrivalStation').value = '';
    }
}

function toggleDepartureFields() {
    const mode = document.getElementById('departureMode').value;
    const flight = document.getElementById('departureFlightFields');
    const train = document.getElementById('departureTrainFields');
    flight.style.display = 'none';
    train.style.display = 'none';
    if (mode === 'FLIGHT') {
        flight.style.display = 'flex';
        document.getElementById('departureTrainNumber').value = '';
        document.getElementById('departureStation').value = '';
    } else if (mode === 'TRAIN') {
        train.style.display = 'flex';
        document.getElementById('departureFlightNumber').value = '';
        document.getElementById('departureAirport').value = '';
    } else {
        document.getElementById('departureFlightNumber').value = '';
        document.getElementById('departureAirport').value = '';
        document.getElementById('departureTrainNumber').value = '';
        document.getElementById('departureStation').value = '';
    }
}

document.addEventListener('DOMContentLoaded', () => {
    toggleArrivalFields();
    toggleDepartureFields();
    document.getElementById('arrivalMode').addEventListener('change', toggleArrivalFields);
    document.getElementById('departureMode').addEventListener('change', toggleDepartureFields);
});
</script>
</body>
</html>
